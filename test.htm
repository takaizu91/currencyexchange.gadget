<!--<html xmlns="http://www.w3.org/1999/xhtml"> -->
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=Utf-8" />
        <title>Currency Converter 1.0</title>
        <style type="text/css">
        body
        {
            margin: 0;
            width: 130px;
            height: 110px;
            font-family: 'Segoe UI', Tahoma;
            <!-- font-weight: bold; -->
            font-size: 11px;
        }
        #gadgetContent
        {
            margin-top: 5px;
            width: 130px;
            vertical-align: middle;
            text-align: center;
			color: #ffff
            <!-- overflow: hidden; -->
        }
		
		#form1
		{
		}
        </style>
		<script>
			// Enable settingsUI
			System.Gadget.settingsUI="setting.html";
		</script>
		
        <script type="text/jscript" language="jscript">
            // Initialize the gadget.
            function init()
            {
                var oBackground = document.getElementById("imgBackground");
                oBackground.src = "url(images/penguin130x130-2.png)";
				
            }
			
			function initText() 
			{
				oText = document.getElementById("imgBackground").addTextObject("", 
					"Verdana", 10, "black", 0, 0);				
				oText.align = 1;
			}
			
			function showText(newValue)
			{
				oText.value = newValue;
			}
        </script>
		
		<script></script>
		
		<script>
		function doCalc() {
			
			var ccc = document.getElementById("sel1").value;
			var ddd = document.getElementById("sel2").value;
			
			// MYR to other currency
			//--------------------------------------------------
			if (ccc == "MYR" && ddd == "MYR") {		
				var cur = 1;
				var x = document.getElementById("value1").value;			
				var y = x * (1 / cur);
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			if (ccc == "MYR" && ddd == "USD") {
				var cur = 3.6670;
				var x = document.getElementById("value1").value;			
				var y = x * (1 / cur);
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			if (ccc == "MYR" && ddd == "JPY") {
				var cur = 3.0673;
				var x = document.getElementById("value1").value;			
				var y = x * (100 / cur);
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			if (ccc == "MYR" && ddd == "AUD") {
				var cur = 2.8825;
				var x = document.getElementById("value1").value;			
				var y = x * (1 / cur);
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			if (ccc == "MYR" && ddd == "GBP") {
				var cur = 5.4851;
				var x = document.getElementById("value1").value;			
				var y = x * (1 / cur);
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			// USD to other currency
			//---------------------------------------------------
			if (ccc == "USD" && ddd == "MYR") {		
				var cur = 3.6670;
				var x = document.getElementById("value1").value;			
				var y = x * cur;
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			if (ccc == "USD" && ddd == "USD") {		
				var cur = 1;
				var x = document.getElementById("value1").value;			
				var y = x * cur;
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			if (ccc == "USD" && ddd == "JPY") {		
				var cur = 119.499;
				var x = document.getElementById("value1").value;			
				var y = x * cur;
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			if (ccc == "USD" && ddd == "AUD") {		
				var cur = 1.2709;
				var x = document.getElementById("value1").value;			
				var y = x * cur;
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			if (ccc == "USD" && ddd == "GBP") {		
				var cur = 0.6699;
				var x = document.getElementById("value1").value;			
				var y = x * cur;
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			// JPY to other currency
			//---------------------------------------------------
			
			if (ccc == "JPY" && ddd == "MYR") {		
				var cur = 3.0673;
				var x = document.getElementById("value1").value;			
				var y = x * (cur / 100);
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			if (ccc == "JPY" && ddd == "USD") {		
				var cur = 119.475;
				var x = document.getElementById("value1").value;			
				var y = x * (1 / cur);
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			if (ccc == "JPY" && ddd == "JPY") {		
				var cur = 1;
				var x = document.getElementById("value1").value;			
				var y = x * (cur);
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			if (ccc == "JPY" && ddd == "AUD") {		
				var cur = 0.0106;
				var x = document.getElementById("value1").value;			
				var y = x * (cur);
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			if (ccc == "JPY" && ddd == "GBP") {		
				var cur = 0.0056;
				var x = document.getElementById("value1").value;			
				var y = x * (cur);
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			// AUD to other currency
			//---------------------------------------------------
			
			if (ccc == "AUD" && ddd == "MYR") {		
				var cur = 2.8825;
				var x = document.getElementById("value1").value;			
				var y = x * cur;
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			if (ccc == "AUD" && ddd == "USD") {		
				var cur = 0.7872;
				var x = document.getElementById("value1").value;			
				var y = x * cur;
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			if (ccc == "AUD" && ddd == "JPY") {		
				var cur = 94.2563;
				var x = document.getElementById("value1").value;			
				var y = x * cur;
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			if (ccc == "AUD" && ddd == "AUD") {		
				var cur = 1;
				var x = document.getElementById("value1").value;			
				var y = x * cur;
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			if (ccc == "AUD" && ddd == "GBP") {		
				var cur = 0.5297;
				var x = document.getElementById("value1").value;			
				var y = x * cur;
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			// GBP to other currency
			//-----------------------------------------------------
			
			if (ccc == "GBP" && ddd == "MYR") {		
				var cur = 5.4418;
				var x = document.getElementById("value1").value;			
				var y = x * cur;
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			if (ccc == "GBP" && ddd == "USD") {		
				var cur = 1.4869;
				var x = document.getElementById("value1").value;			
				var y = x * cur;
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			if (ccc == "GBP" && ddd == "JPY") {		
				var cur = 177.992;
				var x = document.getElementById("value1").value;			
				var y = x * cur;
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			if (ccc == "GBP" && ddd == "AUD") {		
				var cur = 1.8873;
				var x = document.getElementById("value1").value;			
				var y = x * cur;
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
			
			if (ccc == "GBP" && ddd == "GBP") {		
				var cur = 1;
				var x = document.getElementById("value1").value;			
				var y = x * cur;
				var y2 = y.toFixed(2);
				document.getElementById("value2").value = y2;
			}
		}

		function doCalcRev() {
		
			var eee = document.getElementById("sel1").value;
			var fff = document.getElementById("sel2").value;
			
			// MYR to other currency
			//---------------------------------------------------
			
			if (eee == "MYR" && fff == "MYR") {		
				var cur = 1;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	

			if (eee == "MYR" && fff == "USD") {		
				var cur = 3.6769;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	
			
			if (eee == "MYR" && fff == "JPY") {		
				var cur = 0.0309;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	
			
			if (eee == "MYR" && fff == "AUD") {		
				var cur = 2.8750;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	
			
			if (eee == "MYR" && fff == "GBP") {		
				var cur = 5.4753;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	
			
			// USD to other currency
			//---------------------------------------------------
			
			if (eee == "USD" && fff == "MYR") {		
				var cur = 0.2719;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	

			if (eee == "USD" && fff == "USD") {		
				var cur = 1;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	
			
			if (eee == "USD" && fff == "JPY") {		
				var cur = 0.0084;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	
			
			if (eee == "USD" && fff == "AUD") {		
				var cur = 0.7818;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	
			
			if (eee == "USD" && fff == "GBP") {		
				var cur = 1.4883;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	
			
			// JPY to other currency
			//---------------------------------------------------
			
			if (eee == "JPY" && fff == "MYR") {		
				var cur = 32.3450;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	

			if (eee == "JPY" && fff == "USD") {		
				var cur = 118.908;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	
			
			if (eee == "JPY" && fff == "JPY") {		
				var cur = 1;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	
			
			if (eee == "JPY" && fff == "AUD") {		
				var cur = 92.9509;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	
			
			if (eee == "JPY" && fff == "GBP") {		
				var cur = 176.949;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	
			
			// AUD to other currency
			//---------------------------------------------------
			
			if (eee == "AUD" && fff == "MYR") {		
				var cur = 0.3477;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	

			if (eee == "AUD" && fff == "USD") {		
				var cur = 1.2788;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	
			
			if (eee == "AUD" && fff == "JPY") {		
				var cur = 0.0108;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	
			
			if (eee == "AUD" && fff == "AUD") {		
				var cur = 1;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	
			
			if (eee == "AUD" && fff == "GBP") {		
				var cur = 1.9034;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	
			
			// GBP to other currency
			//---------------------------------------------------
			
			if (eee == "GBP" && fff == "MYR") {		
				var cur = 0.1827;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	

			if (eee == "GBP" && fff == "USD") {		
				var cur = 0.6718;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	
			
			if (eee == "GBP" && fff == "JPY") {		
				var cur = 0.0056;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	
			
			if (eee == "GBP" && fff == "AUD") {		
				var cur = 0.5253;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	
			
			if (eee == "GBP" && fff == "GBP") {		
				var cur = 1;
				var x2 = document.getElementById("value2").value;			
				var y2 = x2 * cur;
				var y3 = y2.toFixed(2);
				document.getElementById("value1").value = y3;
			}	
			//var x2 = document.getElementById("value2").value;
			//var y2 = x2 * 3.6670;
			//var y3 = y2.toFixed(2);
			//document.getElementById("value1").value = y3;
			
			//document.getElementById("val1").innerHTML = "From : USD" + y3;
			//$("#value1").keyup(function() {
			//	x2.value = this.value});
		}
		</script>
		
		<script>
		
		// basically to refresh currency data with latest one
		// by pulling from excel which contain query to get update
		// from BNM web page
		
		function openExcelToRefreshData() {
			var Excel;
			Excel = new ActiveXObject("Excel.Application");	
			Excel.Visible = false;
			form1.my_textarea2.value = Excel.Workbooks.Open("C:/Program Files/Windows Sidebar/Gadgets/Currency_Gadget_Alpha.gadget/bnmrates.xlsx").ActiveSheet.Cells(1,1).Value;
			Excel.Quit();
		
		</script>
		<!-- getting javascript from external source to run -->
		<!--<script src="scripts/exchange.js" ></script> -->
		
    </head>
	
    <body onload="init()" text-align="middle">
        <g:background id="imgBackground">
            <span id="gadgetContent">Currency Converter 1.0</span>
			
			<span><br />
				<select class="wayver" id="sel1" onchange="doCalc()" onchange="doCalcRev()">
					<option value="MYR">MYR</option>
					<option value="USD">USD</option>
					<option value="JPY">JPY</option>
					<option value="AUD">AUD</option>
					<option value="GBP">GBP</option>
				</select>
			<input type="number" class="wayver" id="value1" value="1" maxlength="10" size="5" onkeyup="doCalc()">
			</span>
			<span><br />
				<select class="wayving" id="sel2" onchange="doCalcRev()" onchange="doCalc()">
					<option value="USD">USD</option>
					<option value="MYR">MYR</option>
					<option value="JPY">JPY</option>
					<option value="AUD">AUD</option>
					<option value="GBP">GBP</option>
				</select>					
			<input type="number" class="wayving" id="value2" value="" maxlength="10" size="5" onkeyup="doCalcRev()">
			</span>
			
			<div id="rrate" align="center" onclick="resetrates()">Refresh rates</div>
			
			
        </g:background>
    </body>
</html>
